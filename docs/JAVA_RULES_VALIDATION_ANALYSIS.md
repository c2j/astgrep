# Java è§„åˆ™éªŒè¯åˆ†æ

å‚è€ƒ XML å‘½åç©ºé—´éªŒè¯çš„æ–¹æ³•ï¼Œå¯¹ `tests/java` ä¸‹çš„æ¡ˆä¾‹è¿›è¡Œç¡®è®¤ã€‚

---

## ğŸ“‹ **è§„åˆ™ 1: cs-eh-08-system-out-logging (r1)**

### è§„åˆ™å®šä¹‰

```yaml
- id: cs-eh-08-system-out-logging
  name: "Avoid System.out for Logging"
  description: "Detects usage of System.out and System.err for logging"
  pattern-either:
    - pattern: System.out.println($MESSAGE)
    - pattern: System.out.print($MESSAGE)
    - pattern: System.err.println($MESSAGE)
    - pattern: System.err.print($MESSAGE)
```

### è§„åˆ™æ„å›¾

âœ… æ£€æµ‹ä½¿ç”¨ `System.out` æˆ– `System.err` è¿›è¡Œæ—¥å¿—è¾“å‡ºçš„ä»£ç   
âœ… å»ºè®®ä½¿ç”¨ä¸“ä¸šçš„æ—¥å¿—æ¡†æ¶ï¼ˆå¦‚ SLF4Jã€Log4jï¼‰

### æµ‹è¯•ä»£ç åˆ†æ

#### é¢„æœŸåŒ¹é…ï¼ˆåº”è¯¥æ£€æµ‹ï¼‰

| è¡Œå· | ä»£ç  | é¢„æœŸ | å®é™… | ç¬¦åˆé¢„æœŸ |
|------|------|------|------|---------|
| 4 | `System.out.println("Debug: Processing user data");` | âœ… | âœ… | âœ… |
| 5 | `System.out.print("Status: ");` | âœ… | âœ… | âœ… |
| 6 | `System.err.println("Error occurred: " + getMessage());` | âœ… | âœ… | âœ… |
| 7 | `System.err.print("Warning: ");` | âœ… | âœ… | âœ… |
| 11 | `System.out.println("User ID: " + userId);` | âœ… | âœ… | âœ… |

#### é¢„æœŸä¸åŒ¹é…ï¼ˆä¸åº”è¯¥æ£€æµ‹ï¼‰

| è¡Œå· | ä»£ç  | é¢„æœŸ | å®é™… | ç¬¦åˆé¢„æœŸ |
|------|------|------|------|---------|
| 8 | `//System.err.print("Warning: ");` | âŒ | âŒ | âœ… |
| 16-20 | ä½¿ç”¨ Logger çš„ä»£ç  | âŒ | âŒ | âœ… |

### ç»“è®º

âœ… **è§„åˆ™ 1 ç¬¦åˆé¢„æœŸ** - æ‰€æœ‰åŒ¹é…éƒ½æ˜¯æ­£ç¡®çš„

---

## ğŸ“‹ **è§„åˆ™ 2: taint-maturity (r2)**

### è§„åˆ™å®šä¹‰

```yaml
- id: taint-maturity
  languages: [java]
  severity: ERROR
  pattern-sources:
    - pattern: '"tainted"'
  pattern-sinks:
    - pattern: sink(...)
  pattern-sanitizers:
    - pattern: sanitize(...)
  mode: taint
```

### è§„åˆ™æ„å›¾

âœ… ä½¿ç”¨æ±¡ç‚¹åˆ†æï¼ˆtaint modeï¼‰æ£€æµ‹æ±¡æŸ“æ•°æ®æµ  
âœ… è¿½è¸ªä» `"tainted"` æºåˆ° `sink()` çš„æ•°æ®æµ  
âœ… è¯†åˆ«è¢« `sanitize()` æ¸…ç†çš„æ•°æ®

### æµ‹è¯•ä»£ç åˆ†æ

#### é¢„æœŸåŒ¹é…ï¼ˆåº”è¯¥æ£€æµ‹ï¼‰

| è¡Œå· | ä»£ç  | é¢„æœŸ | å®é™… | ç¬¦åˆé¢„æœŸ |
|------|------|------|------|---------|
| 6 | `sink("tainted");` | âœ… | âœ… | âœ… |
| 18 | `sink(z);` (z æ¥è‡ª "tainted") | âœ… | âœ… | âœ… |

#### é¢„æœŸä¸åŒ¹é…ï¼ˆä¸åº”è¯¥æ£€æµ‹ï¼‰

| è¡Œå· | ä»£ç  | é¢„æœŸ | å®é™… | ç¬¦åˆé¢„æœŸ |
|------|------|------|------|---------|
| 20 | `sink(a);` (a æ¥è‡ª "safe") | âŒ | âŒ | âœ… |
| 22 | `safe(z);` (ä¸æ˜¯ sink) | âŒ | âŒ | âœ… |
| 28 | `sink(sanitize("tainted"));` | âŒ | âŒ | âœ… |
| 37 | `sink(x);` (x è¢« sanitize) | âŒ | âŒ | âœ… |

### ç»“è®º

âœ… **è§„åˆ™ 2 ç¬¦åˆé¢„æœŸ** - æ±¡ç‚¹åˆ†æå·¥ä½œæ­£ç¡®

---

## ğŸ“‹ **è§„åˆ™ 3: java-thread (r3)**

### è§„åˆ™å®šä¹‰

```yaml
- id: java-thread
  languages: [java]
  message: "è‡ªä¸»çº¿ç¨‹"
  patterns:
    - pattern: '$thread.start()'
```

### è§„åˆ™æ„å›¾

âœ… æ£€æµ‹è°ƒç”¨ `.start()` æ–¹æ³•å¯åŠ¨çº¿ç¨‹çš„ä»£ç   
âœ… è¯†åˆ«æ‰€æœ‰åˆ›å»ºå’Œå¯åŠ¨çº¿ç¨‹çš„ä½ç½®

### æµ‹è¯•ä»£ç åˆ†æ

#### é¢„æœŸåŒ¹é…ï¼ˆåº”è¯¥æ£€æµ‹ï¼‰

| è¡Œå· | ä»£ç  | é¢„æœŸ | å®é™… | ç¬¦åˆé¢„æœŸ |
|------|------|------|------|---------|
| 7 | `thread.start();` | âœ… | âœ… | âœ… |
| 11 | `myThread.start();` | âœ… | âœ… | âœ… |
| 14-16 | `new Thread(...).start();` | âœ… | âœ… | âœ… |

#### é¢„æœŸä¸åŒ¹é…ï¼ˆä¸åº”è¯¥æ£€æµ‹ï¼‰

| è¡Œå· | ä»£ç  | é¢„æœŸ | å®é™… | ç¬¦åˆé¢„æœŸ |
|------|------|------|------|---------|
| 22 | `thread.run();` (ç›´æ¥è°ƒç”¨ run) | âŒ | âŒ | âœ… |

### ç»“è®º

âœ… **è§„åˆ™ 3 ç¬¦åˆé¢„æœŸ** - æ‰€æœ‰åŒ¹é…éƒ½æ˜¯æ­£ç¡®çš„

---

## ğŸ“Š **æ€»ä½“éªŒè¯ç»“æœ**

| è§„åˆ™ | æ€»å‘ç°æ•° | é¢„æœŸåŒ¹é… | å®é™…åŒ¹é… | å‡é˜³æ€§ | å‡é˜´æ€§ | ç¬¦åˆé¢„æœŸ |
|------|---------|---------|---------|--------|--------|---------|
| r1 (System.out) | 5 | 5 | 5 | 0 | 0 | âœ… |
| r2 (taint) | 2 | 2 | 2 | 0 | 0 | âœ… |
| r3 (thread) | 3 | 3 | 3 | 0 | 0 | âœ… |
| **æ€»è®¡** | **10** | **10** | **10** | **0** | **0** | **âœ…** |

---

## ğŸ¯ **ç»“è®º**

âœ… **æ‰€æœ‰ Java è§„åˆ™éƒ½ç¬¦åˆé¢„æœŸ**

- âœ… æ²¡æœ‰å‡é˜³æ€§ï¼ˆfalse positivesï¼‰
- âœ… æ²¡æœ‰å‡é˜´æ€§ï¼ˆfalse negativesï¼‰
- âœ… è§„åˆ™é€»è¾‘æ­£ç¡®
- âœ… æ¨¡å¼åŒ¹é…å‡†ç¡®
- âœ… æ±¡ç‚¹åˆ†æå·¥ä½œæ­£ç¡®

---

## ğŸ“ **éªŒè¯æ–¹æ³•**

å‚è€ƒ XML å‘½åç©ºé—´éªŒè¯çš„æ–¹æ³•ï¼š

1. **ç†è§£è§„åˆ™æ„å›¾** - æ˜ç¡®è§„åˆ™æƒ³è¦æ£€æµ‹ä»€ä¹ˆ
2. **åˆ†ææµ‹è¯•ä»£ç ** - æŸ¥çœ‹ä»£ç ä¸­å“ªäº›åº”è¯¥åŒ¹é…ï¼Œå“ªäº›ä¸åº”è¯¥
3. **æ£€æŸ¥å®é™…ç»“æœ** - è¿è¡Œè§„åˆ™å¹¶éªŒè¯è¾“å‡º
4. **å¯¹æ¯”é¢„æœŸ** - ç¡®è®¤å®é™…ç»“æœä¸é¢„æœŸä¸€è‡´
5. **è¯†åˆ«é—®é¢˜** - å¦‚æœæœ‰ä¸ç¬¦åˆé¢„æœŸçš„åœ°æ–¹ï¼Œåˆ†æåŸå› 

---

## âœ… **éªŒè¯å®Œæˆ**

æ‰€æœ‰ Java è§„åˆ™éƒ½å·²éªŒè¯ï¼Œç¬¦åˆé¢„æœŸã€‚

