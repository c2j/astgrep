rules:
  - id: CS-SC-18
    message: "禁止密码硬编码，禁止使用null或者空密码"
    languages: [java]
    severity: ERROR
    
    patterns:
      # 检测硬编码密码的常见模式
      - patterns:
          - pattern-either:
              - pattern: $VAR = "...";
              - pattern: $VAR = '...';
          - metavariable-regex:
              metavariable: $VAR
              regex: "(?i).*(password|passwd|pwd|secret|key|token|credential).*"
          - metavariable-regex:
              metavariable: $VAR
              regex: "^(?!.*\\$\\{|.*\\#\\{).*"  # 排除配置占位符
              
      # 检测空密码
      - patterns:
          - pattern-either:
              - pattern: $VAR = "";
              - pattern: $VAR = null;
          - metavariable-regex:
              metavariable: $VAR
              regex: "(?i).*(password|passwd|pwd).*"
